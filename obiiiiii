
import pandas as pd
import io

def process_load_data(csv_content):
    """
    Modular function to process inbound data and return results.
    """
    # 1. Convert the raw string content from Blob Storage into a DataFrame
    # Using StringIO avoids saving a physical file to the server's disk
    df = pd.read_csv(io.StringIO(csv_content))

    # --- START OF YOUR LOGIC ---
    # This is where you put all that code you previously had 
    # that was "saving results" or doing calculations.
    
    # Example: filtering or transforming
    # processed_df = df.dropna() 
    
    # For now, we'll assume the 'results' is your transformed DataFrame
    results_df = df 
    # --- END OF YOUR LOGIC ---

    # 2. Convert the results DataFrame back into a CSV string
    # This allows main.py to upload it directly back to 'outbound'
    output = io.StringIO()
    results_df.to_csv(output, index=False)
    
    return output.getvalue()
